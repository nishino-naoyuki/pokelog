# PTCGLログリプレイアプリ 画面設計書

## 1. 画面一覧

| 画面ID | 画面名 | 主要機能 |
|--------|--------|---------|
| S-001 | ログ読込画面 | ログファイル選択・読込 |
| S-002 | プレイ画面 | 対戦リプレイ表示 |
| S-003 | カード詳細ポップアップ | カード情報詳細表示 |
| S-004 | エラー画面 | エラーメッセージ表示 |

---

## 2. S-001: ログ読込画面

### 2.1 概要

**目的**: ユーザーがPTCGLログファイルを選択し、アプリに読み込む

**表示タイミング**: アプリ起動時、または「新しいログを読込」選択時

### 2.2 レイアウト

```
┌─────────────────────────────────────────────┐
│                                             │
│          PTCGL ログリプレイアプリ           │
│                                             │
│  ┌───────────────────────────────────────┐ │
│  │                                       │ │
│  │         📁                            │ │
│  │                                       │ │
│  │   PTCGLログファイルを選択してください │ │
│  │                                       │ │
│  │   ┌─────────────────────┐            │ │
│  │   │  ファイルを選択     │            │ │
│  │   └─────────────────────┘            │ │
│  │                                       │ │
│  │   対応形式: .txt                      │ │
│  │                                       │ │
│  └───────────────────────────────────────┘ │
│                                             │
│                                             │
│  使い方:                                    │
│  1. ログファイル(.txt)を選択               │
│  2. 自動で解析が始まります                 │
│  3. プレイ画面で対戦を再生できます         │
│                                             │
└─────────────────────────────────────────────┘
```

### 2.3 UI要素

#### 2.3.1 ファイル選択ボタン

**配置**: 画面中央

**スタイル**:
- 大きめのボタン（200px × 60px）
- 背景色: 青系
- ホバー時: 色を少し濃く
- アイコン: 📁

**テキスト**: 「ファイルを選択」

**動作**:
- クリックでファイル選択ダイアログを開く
- .txt ファイルのみ選択可能

---

#### 2.3.2 ファイル選択ダイアログ

**タイプ**: ネイティブファイル選択ダイアログ

**フィルター**: `*.txt` （テキストファイルのみ）

**動作**:
1. ユーザーがファイルを選択
2. 「開く」をクリック
3. ファイルパスを取得
4. ローディング画面へ遷移

---

#### 2.3.3 ローディング表示

**表示タイミング**: ファイル選択後、解析中

**レイアウト**:
```
┌───────────────────────┐
│                       │
│    ⌛ 解析中...       │
│                       │
│    [=========>    ]   │
│        60%            │
│                       │
└───────────────────────┘
```

**UI要素**:
- スピナーアイコン（⌛または回転アイコン）
- プログレスバー（オプション）
- 進捗率（オプション）

---

### 2.4 状態

| 状態 | 表示内容 |
|------|---------|
| 初期表示 | ファイル選択ボタンと説明文 |
| ホバー | ボタンの色が変わる |
| ローディング | スピナーとプログレスバー |
| エラー | エラー画面へ遷移 |

---

## 3. S-002: プレイ画面

### 3.1 概要

**目的**: PTCGLの対戦をリプレイ表示し、ユーザーが閲覧・操作できる

**表示タイミング**: ログ解析成功後

### 3.2 全体レイアウト

```
┌──────────────────────────────────────────────────────────────┐
│ ┌────────────────────────────────────────────────────────┐   │
│ │ Turn # 3 - Player1's Turn          [⏮][⏪][⏸][▶][⏩][⏭] │   │
│ │                                    速度: [====•====]    │   │
│ └────────────────────────────────────────────────────────┘   │
├──────────────────────────────────────────────────────────────┤
│ [相手サイド]       [相手ベンチ] (5匹まで横並び)      [相手トラッシュ] │
│   [6]          ┌──┐ ┌──┐ ┌──┐ ┌──┐ ┌──┐          (15)      │
│   ■           │🔥│ │⚡│ │💧│ │  │ │  │        [相手山札]   │
│   ■           └──┘ └──┘ └──┘ └──┘ └──┘          [裏面]     │
│   ■                                                            │
│               [スタジアム]   [相手バトル場]                      │
│   ■            ┌────┐        ┌───────┐                     │
│   ■            │🏟  │        │ [30]  │                     │
│   ■            └────┘        │ ⚡☠️  │                     │
│                              │ピカチュウ│                     │
│                              │ ex      │                     │
│                              │🌿⚡⚡ │                     │
│                              └───────┘                     │
│                                                              │
│                              [自分バトル場]                      │
│                              ┌───────┐                     │
│                              │       │                     │
│                              │リザード│                     │
│                              │  ex    │                     │
│                              │🔥🔥🔥│                     │
│                              └───────┘                     │
│                                                              │
│ [自分サイド]       [自分ベンチ] (5匹まで横並び)      [自分トラッシュ] │
│   [6]          ┌──┐ ┌──┐ ┌──┐ ┌──┐ ┌──┐          (8)       │
│   ■           │  │ │  │ │  │ │  │ │  │        [自分山札]   │
│   ■           └──┘ └──┘ └──┘ └──┘ └──┘          (45)       │
│   ■                                                            │
│                                                              │
│                    [手札エリア]                               │
│     ┌──┐ ┌──┐ ┌──┐ ┌──┐ ┌──┐ ┌──┐ ┌──┐           │
│     │  │ │  │ │  │ │  │ │  │ │  │ │  │           │
│     └──┘ └──┘ └──┘ └──┘ └──┘ └──┘ └──┘           │
├──────────────────────────────────────────────────────────────┤
│ [ログエリア]                                    [新規読込]   │
│ > Player1 がネストボールを使用しました。                    │
│ > Player1 がロトムVを引いてベンチに出しました。             │
│ > Player1 が山札をシャッフルしました。                      │
│ > Player1 のロトムVが「インスタントチャージ」を使いました。│
│ > Player1 がカードを3枚引きました。                         │
└──────────────────────────────────────────────────────────────┘
```

### 3.3 UI要素詳細

#### 3.3.1 ヘッダー部（ターン表示とコントロール）

**配置**: 最上部

**要素**:
- **ターン表示**: `Turn # X - PlayerName's Turn`
  - フォント: 大きめ、太字
  - 色: アクティブプレイヤーを強調（青または緑）

- **再生コントロールボタン**:
  - ⏮ **最初へ**: ゲーム開始時に戻る
  - ⏪ **前へ**: 1アクション戻る
  - ⏸ **一時停止**: 自動再生を停止
  - ▶ **再生**: 自動再生開始
  - ⏩ **次へ**: 1アクション進む
  - ⏭ **最後へ**: ゲーム終了時へ

- **再生速度スライダー**:
  - 範囲: 0.5x 〜 3.0x
  - デフォルト: 1.0x
  - 表示: 「速度: 1.0x」

**ステップ実行の操作**:
- **1アクション進む**: ⏩ ボタンをクリック（1回クリックで1つのアクションを実行）
- **1アクション戻る**: ⏪ ボタンをクリック（1回クリックで1つのアクション戻る）
- **一時停止**: 自動再生中に ⏸ ボタンをクリックすると停止し、ステップ実行が可能になります

---

#### 3.3.2 バトル場エリア

**相手バトル場**:
```
┌───────────┐
│  [50]     │  ← ダメカン（右上）
│  ☠️🔥     │  ← 特殊状態アイコン（左上）
│           │
│ リザードン │
│  VSTAR    │
│           │
├───────────┤
│🔥🔥🔥🔥 │  ← エネルギー（下部）
│🔧        │  ← ポケモンのどうぐ（左中央）
└───────────┘
```

**サイズ**: 大サイズ（200px × 280px程度）

**表示情報**:
- カード画像
- ダメカン（数値、右上）
- 特殊状態アイコン（左上）
- エネルギー（カード下部に横並び）
- ポケモンのどうぐ（左中央）

**インタラクション**:
- クリックで詳細表示

---

**自分バトル場**:
- 相手バトル場と同じレイアウト
- 配置: 画面中央下部

---

#### 3.3.3 ベンチエリア

**通常時（5匹まで）**:
```
┌──┐ ┌──┐ ┌──┐ ┌──┐ ┌──┐
│🔥│ │⚡│ │💧│ │  │ │  │
└──┘ └──┘ └──┘ └──┘ └──┘
```

**サイズ**: 小サイズ（100px × 140px程度）

**拡張時（6〜8匹）**:
```
┌──┐ ┌──┐ ┌──┐ ┌──┐
│🔥│ │⚡│ │💧│ │🌿│
└──┘ └──┘ └──┘ └──┘
┌──┐ ┌──┐ ┌──┐ ┌──┐
│  │ │  │ │  │ │  │
└──┘ └──┘ └──┘ └──┘
```

**表示情報**:
- カード画像（小）
- ダメカン（簡易表示）

> [!NOTE]
> **ルール上の注意**: ポケモンがバトル場からベンチに戻ると、特殊状態（どく、やけど、ねむり、マヒ、こんらん）はすべて回復します。そのため、ベンチポケモンには特殊状態アイコンは表示しません。

---

#### 3.3.4 手札エリア

**配置**: 画面最下部

**表示**:
- 自分の手札: カード画像を表示
- 相手の手札: カード裏面を表示

**サイズ**: ベンチと同じ（100px × 140px）

**インタラクション**:
- クリックで詳細表示（自分の手札のみ）

---

#### 3.3.5 山札・トラッシュエリア

**配置**: 画面右側

**山札**:
```
┌────┐
│裏面│
│    │
└────┘
(数)
```

**トラッシュ**:
```
┌────┐
│一番│
│上の│
│カード│
└────┘
(15)  ← 枚数表示
```

**インタラクション**:
- クリックでトラッシュの内容をリスト表示（モーダル）

---

#### 3.3.6 サイドカード

**配置**: 画面左側（上部：相手、下部：自分）

**表示**:
```
[6]  ← 残数
■
■
■
```

**サイズ**: 小（50px × 70px）

---

#### 3.3.7 スタジアムカード

**配置**: 画面左側（中央付近、バトル場の横）

**表示**:
```
┌────────┐
│        │
│スタジアム│
│カード  │
│        │
└────────┘
```

**サイズ**: 中サイズ（120px × 168px）

**インタラクション**:
- クリックで詳細表示

---

#### 3.3.8 ログエリア

**配置**: 画面下部（または右サイド）

**サイズ**: 高さ200px程度、スクロール可能

**表示形式**:
```
> Player1 がカードを1枚引きました。
> Player1 がネストボールを使用しました。
> Player1 がロトムVを山札から引いてベンチに出しました。
> Player1 が山札をシャッフルしました。
> Player1 のロトムVが「インスタントチャージ」を使いました。  ← 青色
> Player1 がカードを3枚引きました。
> Player1 のターンが終了しました。
```

**色分け**:
- 通常: 黒
- ワザ使用: 青
- きぜつ: 赤
- サイド取得: 金色
- ターン終了: 灰色

**スクロール**:
- 常に最新メッセージが見えるよう自動スクロール
- ユーザーが手動でスクロールした場合は自動スクロール停止

---

#### 3.3.9 新規読込ボタン

**配置**: ログエリア右上

**テキスト**: 「新しいログを読込」

**動作**:
- クリックで確認ダイアログ表示
- 「はい」でログ読込画面へ遷移

---

### 3.4 エフェクト表示

#### 3.4.1 ワザ使用時

**エフェクト種類**:

1. **攻撃ワザ**:
   - 攻撃元からターゲットへ光線エフェクト
   - ターゲット周辺にフラッシュ
   - ダメージ数値がポップアップ表示（例: `-120`）
   - 色: 赤系

2. **サポートワザ**:
   - 使用したポケモンの周りに緑の光
   - 回復・強化の場合は `+` 記号
   - 色: 緑系

3. **特殊状態付与**:
   - 該当する特殊状態アイコンが浮かび上がる
   - アニメーション: フェードイン＋回転

**表示時間**: 1〜2秒

---

#### 3.4.2 ポケモンきぜつ時

**エフェクト**:
- きぜつしたポケモンが半透明になる
- トラッシュへ移動するアニメーション（スライド）
- サイドカードが手札へ移動するアニメーション

**効果音**: （オプション）きぜつ音

---

### 3.5 レスポンシブ対応

**推奨解像度**: 1280x720 以上

**最小解像度**: 1024x600

**タブレット対応**:
- ベンチのサイズを調整
- ログエリアを折りたたみ可能に

---

## 4. S-003: カード詳細ポップアップ

### 4.1 概要

**目的**: クリックされたカードの詳細情報を大きく表示

**表示タイミング**: ユーザーがカードをクリックしたとき

### 4.2 レイアウト

```
┌─────────────────────────────────────────────┐
│                      [×]                    │  ← 閉じるボタン
│                                             │
│             ┌───────────────┐              │
│             │                │              │
│             │                │              │
│             │  カード画像    │              │
│             │  (大サイズ)    │              │
│             │                │              │
│             │                │              │
│             │                │              │
│             └───────────────┘              │
│                                             │
│  カード名: ピカチュウex                     │
│  HP: 190                                    │
│                                             │
│  ワザ:                                      │
│  ⚡⚡ サンダーボルト (120ダメージ)         │
│       このポケモンについているエネルギー   │
│       をすべてトラッシュする。             │
│                                             │
│  弱点: 闘 ×2                                │
│  抵抗力: なし                               │
│  にげる: ⚪                                 │
│                                             │
└─────────────────────────────────────────────┘
```

### 4.3 UI要素

#### 4.3.1 背景オーバーレイ

**スタイル**:
- 半透明の黒背景（opacity: 0.7）
- 画面全体を覆う
- クリックで閉じる

---

#### 4.3.2 カード画像

**サイズ**: 大サイズ（400px × 560px程度）

**配置**: 中央

---

#### 4.3.3 カード情報

**表示内容**:
- カード名
- HP
- ワザ（名前、コスト、ダメージ、効果）
- 弱点
- 抵抗力
- にげるコスト

**フォント**: 読みやすいサイズ（16px以上）

---

#### 4.3.4 閉じるボタン

**配置**: 右上

**アイコン**: ×

**動作**:
- クリックでポップアップを閉じる
- ESCキーでも閉じる
- オーバーレイクリックでも閉じる

---

## 5. S-004: エラー画面

### 5.1 概要

**目的**: エラー発生時にユーザーに通知し、対処方法を示す

**表示タイミング**: ログ解析失敗時、その他のエラー発生時

### 5.2 レイアウト

```
┌───────────────────────────────────────┐
│                                       │
│          ❌ エラーが発生しました       │
│                                       │
│  ┌─────────────────────────────────┐ │
│  │                                 │ │
│  │  ログファイルの形式が不正です。 │ │
│  │                                 │ │
│  │  以下を確認してください:       │ │
│  │  ・ファイルが.txt形式か         │ │
│  │  ・PTCGLのログファイルか       │ │
│  │  ・ファイルが壊れていないか     │ │
│  │                                 │ │
│  └─────────────────────────────────┘ │
│                                       │
│          ┌──────────┐               │
│          │  戻る    │               │
│          └──────────┘               │
│                                       │
└───────────────────────────────────────┘
```

### 5.3 UI要素

#### 5.3.1 エラーアイコン

**アイコン**: ❌ または ⚠️

**サイズ**: 大きめ（64px）

---

#### 5.3.2 エラーメッセージ

**表示内容**:
- エラーの概要
- 原因の推測
- 対処方法

**フォント**: 読みやすい（16px）

**色**: 赤系（エラーを強調）

---

#### 5.3.3 戻るボタン

**配置**: 中央下部

**テキスト**: 「戻る」

**動作**: ログ読込画面へ遷移

---

## 6. デザインガイドライン

### 6.1 カラースキーム

| 用途 | 色 | コード |
|------|---|-------|
| プライマリー | 青 | #2196F3 |
| セカンダリー | 緑 | #4CAF50 |
| エラー | 赤 | #F44336 |
| 警告 | オレンジ | #FF9800 |
| 背景 | 白/ライトグレー | #FFFFFF / #F5F5F5 |
| テキスト | 黒 | #212121 |

### 6.2 フォント

- **見出し**: Sans-serif、太字、18px以上
- **本文**: Sans-serif、通常、14px以上
- **ログ**: Monospace、12px以上

### 6.3 スペーシング

- **余白**: 最小8px、標準16px、大きめ24px
- **カード間**: 8px
- **セクション間**: 24px

---

## 7. アクセシビリティ

### 7.1 キーボード操作

- **Tab**: フォーカス移動
- **Enter**: ボタン実行
- **Space**: 再生/一時停止
- **→**: 次へ
- **←**: 前へ
- **ESC**: ポップアップを閉じる

### 7.2 スクリーンリーダー対応

- すべてのボタンに`aria-label`を追加
- 画像に`alt`テキストを追加
- フォーカスインジケーターを明確に表示

---

## 8. まとめ

この画面設計書は、PTCGLログリプレイアプリケーションの全ての画面の詳細なレイアウトとUI要素を定義しています。

**主要画面:**
1. ログ読込画面: シンプルで分かりやすい
2. プレイ画面: 詳細な情報を視覚的に表示
3. カード詳細ポップアップ: 大きくて見やすい
4. エラー画面: 明確なエラーメッセージ

**デザインの特徴:**
- 直感的で使いやすいUI
- 視覚的にリッチな表示
- アクセシビリティへの配慮
- レスポンシブ対応
